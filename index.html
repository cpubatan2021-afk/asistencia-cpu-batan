<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Asistencia - CPU</title>
    <style>
        /* ... (todos tus estilos actuales, sin cambios) ... */
    </style>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <script>
        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCgg_9oBHyr5ouu8WUYVokD0JWIvnA1oj0",
            authDomain: "cpu-batan.firebaseapp.com",
            databaseURL: "https://cpu-batan-default-rtdb.firebaseio.com",
            projectId: "cpu-batan",
            storageBucket: "cpu-batan.appspot.com",
            messagingSenderId: "513877189909",
            appId: "1:513877189909:web:3eb1114e62b082017e751c"
        };
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
    </script>
</head>
<body>
    <!-- ... (todo tu HTML actual, sin cambios) ... -->
    <script>
        // Base de datos simulada por mes
        var db = {
            meses: [],
            tipoMateriaActual: 'extension',
            tipoMateriaSeleccionado: null,
            mesActual: 0,
            materiaAEliminar: null,
            alumnoAEditar: null,
            actual: null,
            userType: null // 'admin' o 'viewer'
        };

        // Inicializar la base de datos por mes
        function initDB() {
            for (let i = 0; i < 12; i++) {
                db.meses.push({
                    id: i,
                    materias: [],
                    alumnos: []
                });
            }
        }

        // Guardar datos en Firebase
        function guardarDatos() {
            database.ref('dbCPU').set(db);
        }

        // Cargar datos desde Firebase
        function cargarDatos() {
            database.ref('dbCPU').once('value')
                .then((snapshot) => {
                    const datos = snapshot.val();
                    if (datos) {
                        db = datos;
                    } else {
                        initDB(); // Si no hay datos, inicializa
                    }
                    render(); // Actualiza la vista
                });
        }

        // Escuchar cambios en tiempo real
        database.ref('dbCPU').on('value', (snapshot) => {
            const datos = snapshot.val();
            if (datos) {
                db = datos;
                render(); // Actualiza la vista automáticamente
            }
        });

        // Variables para el carousel
        let currentSlide = 0;
        let slides = [];
        let slideInterval;

        // Inicializar la aplicación
        function init() {
            cargarDatos(); // Cargar datos desde Firebase
            db.mesActual = parseInt(document.getElementById('mesSelector').value);
            updateClock();
            setInterval(updateClock, 1000);
        }

        // ... (todas tus funciones actuales, sin cambios) ...

        // Inicializar la aplicación
        init();
    </script>
    <script>
        // Mostrar el modal de login al cargar la página
        window.onload = function() {
            document.getElementById('loginModal').style.display = 'flex';
        };
    </script>
</body>
</html>
